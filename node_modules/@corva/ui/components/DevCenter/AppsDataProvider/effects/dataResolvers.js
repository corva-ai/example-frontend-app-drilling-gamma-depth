import t from"@babel/runtime/helpers/toConsumableArray";import{get as r,keyBy as e,values as n,merge as a,flatten as u,uniq as i}from"lodash";import c from"@babel/runtime/helpers/slicedToArray";import{ASSET_TYPES as o}from"../../../../constants/assetTypes.js";import s from"@babel/runtime/regenerator";import p from"@babel/runtime/helpers/asyncToGenerator";import{getAppsDataByRigs as d,fetchRigs as f,getAppsDataByWells as l,fetchWells as m,fetchAssetEntitiesByAssetIds as b,getAppsDataByFFs as y,getAppsDataByPads as x,getUniqAssetIds as h,fetchFracFleets as v,fetchFracFleetWells as k,fetchPadWells as w}from"./utils.js";function F(t,r){return I.apply(this,arguments)}function I(){return(I=p(s.mark((function t(a,u){var i,c,p,y,x,h,v,k,w,F;return s.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,b([a]);case 2:if(i=t.sent,c=r(n(i),"[0][0].data")){t.next=6;break}return t.abrupt("return",{});case 6:if(c.type!==o.well.type){t.next=16;break}return t.next=9,m([c.id]);case 9:if(p=t.sent){t.next=12;break}return t.abrupt("return",{});case 12:return y=r(p,"data"),x=y&&e(y.concat(p.included),"id"),h=l(u,x,(function(t){return t[r(p,"data[0].id")]})),t.abrupt("return",h);case 16:if(c.type!==o.rig.type){t.next=24;break}if(v=f([c.id])){t.next=20;break}return t.abrupt("return",{});case 20:return k=r(v,"data"),w=k&&e(k.concat(v.included),"id"),F=d(u,w,(function(t){return t[r(v,"data[0].id")]})),t.abrupt("return",F);case 24:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function g(t){return T.apply(this,arguments)}function T(){return(T=p(s.mark((function r(n){var u,i,o,p,b,F,I,g,T,P,j,A,S,W,C,G,R,_,q,z,B,D,E,H,J;return s.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return u=n.appsWellIds,i=n.appsRigIds,o=n.appsFracFleetIds,p=n.apps,b=n.appsPadIds,F=n.appsFracFleetToFetchWellsIds,I=h(u),g=h(i),T=h(o),P=t(new Set(F)),j=t(new Set(b)),r.next=8,Promise.all([m(I),f(g),v(T),k(P,p),w(j,p)]);case 8:if(A=r.sent,S=c(A,5),W=S[0],C=S[1],G=S[2],R=S[3],_=S[4],W||C||G||R||_){r.next=17;break}return r.abrupt("return",{});case 17:return q=(null==W?void 0:W.data)&&e(W.data.concat(W.included),"id"),z=(null==C?void 0:C.data)&&e(C.data.concat(C.included),"id"),B=e(G,"id"),D=l(u,q,(function(t,r){return t[r]})),E=d(i,z,(function(t,r){return t[r]})),H=y(o,B,R),J=x(b,_),r.abrupt("return",a(D,E,H,J));case 25:case"end":return r.stop()}}),r)})))).apply(this,arguments)}function P(t,r,e){return j.apply(this,arguments)}function j(){return(j=p(s.mark((function t(p,y,x){var v,k,w,F,I,g,T,P,j,A,S,W,C,G,R,_;return s.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return v=h(p),t.next=3,b(v);case 3:return k=t.sent,w=u(n(k)),F=i(w.filter((function(t){return r(t,"data.type")===o.well.type})).map((function(t){return+r(t,"data.id")})).concat(y.map((function(t){var r=c(t,2);r[0];return r[1]})))),I=i(w.filter((function(t){return r(t,"data.type")===o.rig.type})).map((function(t){return+r(t,"data.id")})).concat(x.map((function(t){var r=c(t,2);r[0];return r[1]})))),t.next=9,Promise.all([m(F),f(I)]);case 9:if(g=t.sent,T=c(g,2),P=T[0],j=T[1],P||j){t.next=15;break}return t.abrupt("return",{});case 15:return A=r(P,"data"),S=r(j,"data"),W=A&&e(A.concat(P.included),"id"),C=S&&e(S.concat(j.included),"id"),G=p.map((function(t){var e=c(t,2),n=e[0],a=e[1];return[n,A.concat(S).find((function(t){return r(t,"attributes.asset_id")===a})).id]})).concat(y,x),R=l(G,W,(function(t,r){return t[r]})),_=d(G,C,(function(t,r){return t[r]})),t.abrupt("return",a(R,_));case 23:case"end":return t.stop()}}),t)})))).apply(this,arguments)}export{F as resolveAppsDataForAssetDashboard,P as resolveAppsDataForFeedPage,g as resolveAppsDataForGeneralDashboard};
