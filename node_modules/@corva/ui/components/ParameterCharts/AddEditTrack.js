import t from"@babel/runtime/helpers/defineProperty";import e from"@babel/runtime/helpers/toConsumableArray";import r from"@babel/runtime/helpers/slicedToArray";import{jsxs as n,Fragment as i,jsx as o}from"react/jsx-runtime";import{withStyles as s,Button as c}from"@material-ui/core";import{useState as a,useEffect as p}from"react";import l from"uuid/v1";import m from"prop-types";import u from"../Modal/index.js";import{DEFAULT_TRACK_SETTINGS as d,SETTINGS_KEY as f}from"./constants.js";import g from"./components/TrackSettings.js";import b from"./components/SingleChannelTrackSettings.js";import"./AddEditTrack.css.js";function y(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function h(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?y(Object(n),!0).forEach((function(r){t(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var O=function(s){var m=s.children,f=s.classes,y=s.id,O=s.settings,j=s.onSettingsChange,k=s.settingsKey,v=s.mapping,C=s.multipleAssets,S=a(!1),P=r(S,2),T=P[0],A=P[1],D=a(d),q=r(D,2),w=q[0],R=q[1],E=function(e,r){R(h(h({},w),{},t({},e,r)))};p((function(){var t=y?O[k].find((function(t){return t.id===y})):d;R(t)}),[O,k,y]);return n(i,{children:[o("div",{className:f.link,onClick:y?function(){return A(!0)}:function(){j(h(h({},O),{},t({},k,[].concat(e(O&&O[k]||[]),[h(h({},w),{},{id:l()})])))),R(d)},children:m}),o(u,{open:T,title:"Track Settings",actions:n("div",{className:"c-pc-track-setting-actions",children:[y&&o(c,{className:f.button,color:"primary",onClick:function(){var e=O[k].filter((function(t){return t.id!==y}));j(h(h({},O),{},t({},k,e))),A(!1)},children:"Delete Track"}),o(c,{"data-testid":"".concat("DC_AddEditTrack","_cancel"),className:f.button,color:"primary",onClick:function(){var t=y?O[k].find((function(t){return t.id===y})):d;R(t),A(!1)},children:"Cancel"}),o(c,{"data-testid":"".concat("DC_AddEditTrack","_save"),className:f.button,variant:"contained",color:"primary",onClick:function(){var e=O[k].map((function(t){return t.id===y?w:t}));j(h(h({},O),{},t({},k,e))),A(!1)},children:"Save"})]}),children:C?o(b,{trackSettings:w,onChange:E,mapping:v}):o(g,{settings:w,onChange:E,mapping:v})})]})};O.propTypes={settingsKey:m.string,multipleAssets:m.bool,settings:m.shape({}),onSettingsChange:m.func.isRequired,children:m.element.isRequired,id:m.string,mapping:m.arrayOf(m.shape({name:m.string.isRequired,key:m.string.isRequired}).isRequired).isRequired},O.defaultProps={id:"",settingsKey:f,settings:{},multipleAssets:!1};var j=s({link:{cursor:"pointer"},button:{fontSize:14,marginLeft:20}})(O);export default j;
