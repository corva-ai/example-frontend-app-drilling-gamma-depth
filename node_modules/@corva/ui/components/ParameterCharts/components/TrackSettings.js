import e from"@babel/runtime/helpers/defineProperty";import r from"@babel/runtime/helpers/toConsumableArray";import t from"@babel/runtime/helpers/slicedToArray";import{jsxs as n,jsx as i}from"react/jsx-runtime";import{withStyles as a,Grid as o,FormControl as c,TextField as s,IconButton as l,Button as m}from"@material-ui/core";import{useState as u}from"react";import p from"uuid";import d from"prop-types";import f from"../../Modal/index.js";import{MAX_TRACE_COUNT as h,DEFAULT_TRACE_SETTINGS as g}from"../constants.js";import v from"@material-ui/icons/NavigateNext";import b from"@material-ui/icons/Add";import y from"../../ColorPicker/ColorPicker.js";import k from"./TraceSelect.js";import N from"./TraceSettings.js";import O from"./TrackSettings.css.js";function j(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function C(r){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(Object(n),!0).forEach((function(t){e(r,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(n,e))}))}return r}var T=function(a){var d=a.settings,j=d.name,T=d.traces,P=a.onChange,S=a.classes,q=a.mapping,w=u(!1),D=t(w,2),R=D[0],B=D[1],x=u(),A=t(x,2),E=A[0],I=A[1],z=T&&T.length>h,L=function(){var e=T.map((function(e){return e.id===E.id?E:e}));P("traces",e),B(!1)};return n(o,{className:S.container,children:[i(c,{className:S.input,children:i(s,{label:"Track Name",value:j,className:S.input,onChange:function(e){var r=e.target.value;return P("name",r)}})}),i("div",{className:O.title,children:"Traces: "}),T&&!!T.length&&i("div",{className:O.tracesContainer,children:T.map((function(r,t){var a=r.id,o=r.key,c=r.color;return n("div",{className:O.tracesItem,children:[i(k,{value:o,onChange:function(e){return function(e,r){var t=T.map((function(t){var n=q.find((function(e){var t=e.key;return r===t}));return t.id===e?C(C({},t),n):t}));P("traces",t)}(a,e)},mapping:q}),i("div",{className:O.colorPicker,children:i(y,{value:c,onChange:function(r){return function(r,t,n){var i=T.map((function(i){return i.id===r?C(C({},i),{},e({},t,n)):i}));P("traces",i)}(a,"color",r)},hideLabel:!0,buttonClassName:S.picker})}),i(l,{onClick:function(){return function(e){I(T[e]),B(!0)}(t)},className:S.navBtn,children:i(v,{fontSize:"small",className:S.navIcon})})]},a)}))}),!z&&n(m,{color:"primary",onClick:function(){T&&T.length?P("traces",[].concat(r(T),[C({id:p()},g)])):P("traces",[C({id:p()},g)])},children:[i(b,{}),i("span",{children:"Add Trace"})]}),i(f,{open:R,title:n("div",{className:O.modalTitle,children:[n("span",{className:O.trackTitle,onClick:L,children:["Track Settings /"," "]}),E&&E.name||"Empty Trace"]}),actions:n("div",{className:O.actions,children:[i(m,{className:S.button,color:"primary",onClick:function(){var e=T.filter((function(e){return e.id!==E.id}));P("traces",e),B(!1)},children:"Delete Trace"}),i(m,{className:S.button,color:"primary",onClick:function(){return B(!1)},children:"Cancel"}),i(m,{className:S.button,variant:"contained",color:"primary",onClick:L,children:"Save"})]}),children:i(N,{traceSettings:E,onChange:function(r,t){I(C(C({},E),{},e({},r,t)))},mapping:q})})]})};T.propTypes={settings:d.shape({name:d.string.isRequired,traces:d.arrayOf(d.shape({}))}).isRequired,onChange:d.func.isRequired,classes:d.shape({}).isRequired,mapping:d.arrayOf(d.shape({name:d.string.isRequired,key:d.string.isRequired}).isRequired).isRequired};var P=a((function(e){return{container:{paddingTop:20,minWidth:300},input:{width:200},picker:{width:36,minWidth:36,height:24},navBtn:{position:"absolute",right:-10,top:"50%",transform:"translate(0, -50%)"},navIcon:{color:"#BDBDBD"},button:{fontSize:14,marginLeft:20}}}))(T);export default P;
