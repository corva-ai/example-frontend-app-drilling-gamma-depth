import e from"@babel/runtime/helpers/defineProperty";import{toNumber as r}from"lodash";import{jsx as t}from"react/jsx-runtime";import i from"highcharts";import{useContext as n,useRef as o,useMemo as s,useEffect as a}from"react";import c from"prop-types";import u from"../../SettingsContext.js";import p from"../../DataContext.js";import m from"highcharts-react-official";import f from"../../ChartsContext.js";import l from"./EmptyChart.js";import{getLineOptionsByTrack as h}from"./options.js";import y from"./LineChart.css.js";function d(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);r&&(i=i.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,i)}return t}function x(r){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?d(Object(i),!0).forEach((function(t){e(r,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(i)):d(Object(i)).forEach((function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(i,e))}))}return r}var g=function(e){var c=e.traceSettings,d=e.trackIndex,g=n(p),b=g.parsedData,j=g.indexes,O=n(f).onChartChange,v=n(u),C=v.maxTracesCount,S=v.multipleAssets,P=v.assestColors,M=o(),k=s((function(){var e=h(d),t=e.yAxis;if(e.yAxis=[],S){var i=c[0];if(!i)return e;Object.keys(b).forEach((function(n){e.series.push(x(x(x({},i),{},{lineColor:P[n]},b[n]["".concat(i.collection,".").concat(i.key)]),{},{name:n})),e.yAxis.push(x(x({},t),{},{min:!i.autoScale&&i.scaleMin?r(i.scaleMin):void 0,max:!i.autoScale&&i.scaleMax?r(i.scaleMax):void 0}))}))}else c.forEach((function(i){e.series.push(x(x({},i),b["".concat(i.collection,".").concat(i.key)])),e.yAxis.push(x(x({},t),{},{min:!i.autoScale&&i.scaleMin?r(i.scaleMin):void 0,max:!i.autoScale&&i.scaleMax?r(i.scaleMax):void 0}))}));return e}),[c,b]);a((function(){M.current&&M.current.chart.xAxis[0].setExtremes(j.min,j.max)}),[j.min,j.max]),a((function(){M.current&&M.current.chart.setSize()}),[C]),a((function(){O(d,M)}),[M]);var q=!k.series||!k.series.length||1===k.series.length&&!k.series[0].data;return s((function(){return q?t(l,{}):k&&t(m,{highcharts:i,options:k,ref:M,containerProps:{className:y.container}})}),[k])};g.propTypes={traceSettings:c.arrayOf(c.shape({dashStyle:c.string.isRequired,id:c.string.isRequired,key:c.string,color:c.string,name:c.string,traceType:c.string.isRequired,unit:c.string,lineWidth:c.number.isRequired}).isRequired).isRequired,trackIndex:c.number.isRequired};export default g;
