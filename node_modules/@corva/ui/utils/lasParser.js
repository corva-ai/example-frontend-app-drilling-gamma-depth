import r from"@babel/runtime/helpers/defineProperty";import t from"@babel/runtime/helpers/slicedToArray";import e from"@babel/runtime/helpers/classCallCheck";function n(r,t){var e=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable}))),e.push.apply(e,n)}return e}function i(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?n(Object(i),!0).forEach((function(e){r(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):n(Object(i)).forEach((function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(i,r))}))}return t}var s=function n(){var s=this;e(this,n),r(this,"getConfiguration",(function(r){var e=null,n=null,i=null,o=!1;r.forEach((function(r){if(r.toLowerCase().startsWith("~version"))o=!0;else if(r.toLowerCase().startsWith("~"))o=!1;else{if(o){var a=r.split(" ").filter(Boolean),u=t(a,3),l=u[0],c=u[1],f=u[2];switch(l){case"VERS.":e=c;break;case"WRAP.":n=c;break;case"DLM":i=f}}s.config={version:e,wrap:n,delimiter:i}}}))})),r(this,"parseHeaders",(function(r){var t=r.split("\n");s.getConfiguration(t);var e=!1;return t.reduce((function(r,t){if(t.toLowerCase().startsWith("~curve"))return e=!0,r;if(t.startsWith("~")&&(e=!1),e&&!t.startsWith("#")&&!t.startsWith("\r")){var n=t.split(" ").filter(Boolean);return n?r.push(n[0]):r}return r}),[])})),r(this,"parseData",(function(t,e,n){var s=t.split("\n"),o=!1;return s.reduce((function(t,s){if(s.toLowerCase().startsWith("~a"))return o=!0,t;if(s.startsWith("~")&&(o=!1),o){var a=s.split(/[\t\s,]/).filter(Boolean).reduce((function(t,s,o){var a=e[o],u=n.find((function(r){return r.parsingKey===a}));if(u){var l=u.innerKey;return i(i({},t),{},r({},l,parseFloat(s,2)))}return t}),{});return a.isEmpty()?t:t.push(a)}return t}),[])})),this.config={version:null,wrap:null,delimiter:null}};export default s;
