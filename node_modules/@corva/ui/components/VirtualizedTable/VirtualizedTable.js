import e from"@babel/runtime/helpers/defineProperty";import t from"@babel/runtime/helpers/toConsumableArray";import{getUnitDisplay as r}from"../../utils/convert.js";import{jsx as n,Fragment as i,jsxs as o}from"react/jsx-runtime";import{withStyles as a,IconButton as l,Typography as s,Tooltip as u}from"@material-ui/core";import{useMemo as c,useEffect as d}from"react";import f from"prop-types";import m from"classnames";import{Settings as h,Sort as p,ArrowUpward as b,ArrowDownward as g}from"@material-ui/icons";import{Table as y,Column as w,SortDirection as S}from"react-virtualized";function R(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function x(t){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?R(Object(n),!0).forEach((function(r){e(t,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function O(e,t){var n=e.find((function(e){return e.key===t}))||{},i=n.unitType,o=n.customUnit;return o?"(".concat(o,")"):i?"(".concat(r(i),")"):""}function v(e,t){return(e.find((function(e){return e.key===t}))||{}).headerLabelClassName||""}function C(e,t){return(e.find((function(e){return e.key===t}))||{}).headerLabelUnitClassName||""}function z(r){var a=r.columns,f=r.data,R=r.useColumnSetting,z=r.useFixedColumnWidth,_=r.onOpenSettingDlg,j=r.classes,k=r.width,D=r.height,T=r.headerHeight,q=r.rowHeight,N=r.showTopSettingIcon,I=r.customMuiStyles,L=r.isTopSettingIconShownAlways,P=r.CustomCellRenderer,H=r.customRowStyle,B=r.sort,A=r.sortBy,W=r.sortDirection,E=x(x({},j),I),F=c((function(){return{label:"",key:"setting",width:R?25:0}}),[R]),K=c((function(){return a.filter((function(e){return e.show}))}),[a]),V=c((function(){return R?[].concat(t(K),[F]):K}),[K,R,F]),M=c((function(){if(k<=0)return{};var t=e({},F.key,F.width),r=[];return K.filter((function(e){return Number.isFinite(e.width)})).forEach((function(e){t[e.key]=e.width-1,r.push(e.width-1)})),K.filter((function(e){return!Number.isFinite(e.width)})).forEach((function(e){var n=r.reduce((function(e,t){return e+t}),0),i=Math.floor((k-n-F.width)/(K.length-r.length)),o=e.minWidth||65,a=i<o?o:i;t[e.key]=a-1,r.push(a-1)})),t}),[k,K,F]),G=c((function(){return Object.values(M).reduce((function(e,t){return e+t}),0)}),[M]),U=L||G-12.5>=k;d((function(){N(U)}),[U]);var Z=function(e){var t=e.label,r=e.dataKey,i=A||W||B;return r===F.key?U?null:n(l,{size:"small","aria-label":"customize columns",className:E.settingIcon,onClick:_,children:n(h,{fontSize:"inherit"})}):o(s,{variant:"body2",className:m(E.headerLabel,v(a,r)),children:[t,"Â ",n("span",{className:m(E.unitLabel,C(a,r)),children:O(a,r)}),i&&r!==A&&n(u,{title:"Sort A-Z",children:n(p,{fontSize:"small",className:j.sortIcon})}),i&&r===A&&(W===S.ASC?n(b,{fontSize:"small",className:j.sortIcon}):n(g,{fontSize:"small",className:j.sortIcon}))]})},J=function(e){var t=e.dataKey,r=e.rowData;return P?n(P,{columnKey:t,value:r[t]}):n(s,{variant:"body2",className:E.cellData,children:r[t]})};return n(i,{children:n(y,{width:z?G:k,height:D,headerHeight:T,rowClassName:function(t){var r=t.index;return m(e({},E.oddRow,r%2==1))},rowHeight:q,rowCount:f.length,rowGetter:function(e){var t=e.index;return f[t]},rowStyle:H||{},className:E.table,sort:B,sortBy:A,sortDirection:W,children:V.map((function(e){return n(w,{width:M[e.key]||0,dataKey:e.key,label:e.label,headerRenderer:Z,cellRenderer:J},e.key)}))})})}z.propTypes={columns:f.arrayOf(f.shape({})).isRequired,data:f.arrayOf(f.shape({})).isRequired,useColumnSetting:f.bool.isRequired,useFixedColumnWidth:f.bool.isRequired,headerHeight:f.number.isRequired,rowHeight:f.number.isRequired,width:f.number.isRequired,height:f.number.isRequired,onOpenSettingDlg:f.func.isRequired,showTopSettingIcon:f.func.isRequired,sort:f.func,sortBy:f.string,sortDirection:f.string,classes:f.shape({}).isRequired,customMuiStyles:f.shape({table:f.string,oddRow:f.string,headerLabel:f.string,cellData:f.string,unitLabel:f.string,settingIcon:f.string}).isRequired,isTopSettingIconShownAlways:f.bool.isRequired,CustomCellRenderer:f.func,customRowStyle:f.func},z.defaultProps={CustomCellRenderer:null,customRowStyle:null,sort:null,sortBy:null,sortDirection:null};var _=a((function(e){return{table:{"& .ReactVirtualized__Table__headerRow":{textTransform:"none",borderBottom:e.isLightTheme?"1px solid rgba(224, 224, 224, 1)":"1px solid rgba(81, 81, 81, 1)"},"& .ReactVirtualized__Table__row":{borderBottom:e.isLightTheme?"1px solid rgba(224, 224, 224, 1)":"1px solid rgba(81, 81, 81, 1)"},"& .ReactVirtualized__Table__Grid":{outline:"none"},"& .ReactVirtualized__Table__headerColumn":{outline:"none"}},oddRow:{backgroundColor:e.isLightTheme?"rgba(189, 189, 189, 0.1)":"#303030"},headerLabel:{lineHeight:"14px",fontSize:"12px",fontStyle:"normal",letterSpacing:"-0.25px",display:"flex",alignItems:"center",flexWrap:"wrap"},cellData:{lineHeight:"14px",fontSize:"12px",fontWeight:"normal",fontStyle:"normal",letterSpacing:"0.15px"},unitLabel:{fontSize:"10px",opacity:.5},settingIcon:{padding:"3px",fontSize:"20px"},sortIcon:{fontSize:"16px"}}}))(z);export default _;
