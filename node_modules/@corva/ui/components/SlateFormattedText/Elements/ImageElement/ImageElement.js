import e from"@babel/runtime/helpers/defineProperty";import{jsxs as t,jsx as r}from"react/jsx-runtime";import{useRef as n,useEffect as i}from"react";import o from"prop-types";import{useSlateStatic as d,ReactEditor as s}from"slate-react";import{Transforms as c}from"slate";import a from"./ImageElement.css.js";function m(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function u(t){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?m(Object(n),!0).forEach((function(r){e(t,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var l=function(e){var o,m=e.attributes,l=e.element,p=e.imageWidth,f=e.mode,v=e.children,h="write"===f,b=n(),y=n(),g=d(),w=new AbortController,O=function(e){b.current&&b.current.style.setProperty("width","".concat(e,"px"))},P=function(){var e=document.getElementById("resizable".concat(l.url)),t=e&&window.getComputedStyle(e).getPropertyValue("width");return t?parseInt(t,10):document.body.clientWidth},j=function e(){c.removeNodes(g,{at:s.findPath(g,l)}),c.insertNodes(g,u(u({},l),{},{dimensions:{width:P()-24}}),{at:s.findPath(g,l)}),document.body.removeEventListener("pointerup",e)},E=document.getElementsByClassName("c-docs-custom-page-content"),L=E&&E[0]&&E[0].offsetWidth-36||.5*document.body.clientWidth,N=function(e){var t=P(),r=e.pageX;document.body.addEventListener("pointermove",(function(e){return function(e,t,r){e.preventDefault(),P()<150||P()>L?O(Math.min(Math.max(P(),150),L)):O(-1*(t-e.pageX)+r)}(e,r,t)}),{signal:w.signal}),document.body.addEventListener("pointerup",j)};i((function(){return b.current&&h&&b.current.addEventListener("mousedown",N),function(){w.abort(),document.body.removeEventListener("pointerup",j),document.body.removeEventListener("pointermove",j),b.current&&b.current.removeEventListener("mousedown",N)}}),[f]);var W=(null===(o=l.dimensions)||void 0===o?void 0:o.width)+24;return t("div",u(u({},m),{},{children:[r("div",{contentEditable:!1,children:l&&r("div",{style:{width:W||p},ref:b,id:"resizable".concat(l.url),className:a.resizable,children:t("div",{className:a.container,children:[h&&r("div",{className:a.handleLeft}),r("img",{src:l.url,className:a.image,ref:y,alt:""}),h&&r("div",{className:a.handleRight})]})})}),v]}))};l.propTypes={attributes:o.shape({}).isRequired,children:o.node.isRequired,element:o.shape({url:o.string.isRequired,dimensions:o.shape({width:o.string})}).isRequired,imageWidth:o.string,mode:o.string},l.defaultProps={imageWidth:void 0,mode:void 0};export default l;
