import e from"@babel/runtime/helpers/defineProperty";import{get as r}from"lodash";import t from"@babel/runtime/helpers/slicedToArray";import n from"@babel/runtime/regenerator";import o from"@babel/runtime/helpers/asyncToGenerator";import{jsxs as i,jsx as c}from"react/jsx-runtime";import{makeStyles as a,Dialog as s,DialogTitle as p,DialogContent as l,Typography as u,DialogActions as f,Button as m}from"@material-ui/core";import{useState as d,useEffect as h}from"react";import{getUsers as b}from"../../../clients/jsonApi/index.js";import y from"prop-types";import g from"classnames";import v from"./UsersChipSelector.js";function O(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function w(r){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){e(r,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(n,e))}))}return r}var j=a({dialog:{width:"600px",height:"600px"},actions:{padding:"8px 40px",boxShadow:"0px -4px 10px rgb(0 0 0 / 25%)"},mobileActions:{paddingRight:"100px"}});function x(a){var y=a.title,O=a.open,x=a.onSave,S=a.onCancel,P=a.currentUser,C=j(),R=!1,U=d([]),k=t(U,2),A=k[0],q=k[1],D=d(new Set),T=t(D,2),E=T[0],N=T[1];h((function(){function e(){return(e=o(n.mark((function e(){var t,o,i;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t={companyId:r(P,["company","id"])},e.next=4,b(t);case 4:o=e.sent,i=(o||[]).filter((function(e){return r(e,"id")!==r(P,"id")})).map((function(e){return w(w({},e),{},{id:r(e,"id"),displayName:"".concat(r(e,"first_name")," ").concat(r(e,"last_name"))})})),q(i),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.error(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]);var _=function(){N(new Set),S()};return i(s,{open:O,onClose:_,fullScreen:R,classes:{paper:g(e({},C.dialog,!0))},children:[c(p,{children:y||"Share Templates"}),i(l,{children:[c(u,{variant:"subtitle1",gutterBottom:!0,children:"Share with users"}),c(v,{users:A,selectedUsers:E,onAddUser:function(e){N((function(r){return new Set(r.add(e))}))},onRemoveUser:function(e){N((function(r){return r.delete(e),new Set(r)}))}})]}),i(f,{className:g(C.actions,e({},C.mobileActions,R)),children:[c(m,{color:"primary",onClick:_,children:"Cancel"}),c(m,{variant:"contained",color:"primary",onClick:function(){x(A.filter((function(e){return E.has(r(e,"id"))}))),N(new Set)},children:"Save"})]})]})}x.propTypes={title:y.string,open:y.bool.isRequired,onSave:y.func.isRequired,onCancel:y.func.isRequired,currentUser:y.shape({}).isRequired},x.defaultProps={title:null};export default x;
