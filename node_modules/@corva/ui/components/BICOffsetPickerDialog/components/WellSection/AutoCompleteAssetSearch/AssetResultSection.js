import{get as e}from"lodash";import t from"@babel/runtime/helpers/slicedToArray";import{jsxs as r,jsx as o}from"react/jsx-runtime";import{makeStyles as i,List as s,ListSubheader as a,Chip as n,ListItem as l,ListItemText as c,Typography as u}from"@material-ui/core";import{useRef as d,useState as p,useEffect as m}from"react";import g from"prop-types";import{SEARCH_CATEGORIES as f}from"./constants.js";var h=i((function(e){return{assetListWrapper:{margin:"8px 0",flex:1},assetListContainer:{maxHeight:350,backgroundColor:e.palette.background.paper,position:"relative",overflow:"auto"},listSection:{backgroundColor:"inherit"},ul:{backgroundColor:"inherit",padding:0},listGutters:{padding:"2px 8px"},assetTypeSubheaderChip:{height:"24px",color:"#BDBDBD"},assetItemTextRoot:{minWidth:"300px"},assetItemTextPrimary:{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},loadingInfo:{textAlign:"center",fontSize:"12px",lineHeight:"17px",color:"#808080"}}})),b=function(i){var g=i.page,b=i.loading,x=i.groupedAssets,T=i.onClickAsset,v=i.onScrollReached,y=h(),R=d(null),S=p("top"),C=t(S,2),A=C[0],H=C[1];m((function(){b||("top"===A&&R.current.scrollTo(0,5),"bottom"===A&&R.current.scrollTo(0,R.current.scrollHeight-R.current.offsetHeight-5))}),[b]);return r("div",{className:y.assetListWrapper,children:[o(s,{className:y.assetListContainer,subheader:o("li",{}),onScroll:function(e){if(e.target.scrollHeight!==e.target.offsetHeight){var r=e.target.scrollTop+e.target.offsetHeight;Math.abs(e.target.scrollHeight-r)<1&&x.find((function(e){var r=t(e,2);return r[0],40===r[1].length}))&&(H("top"),v("bottom")),0===Math.round(e.target.scrollTop)&&g>1&&(H("bottom"),v("top"))}},ref:R,children:x.map((function(i){var s=t(i,2),u=s[0],d=s[1];return o("li",{className:y.listSection,children:r("ul",{className:y.ul,children:[o(a,{classes:{gutters:y.listGutters},children:o(n,{className:y.assetTypeSubheaderChip,variant:"outlined",label:f[u].labelPlural},u)}),d.map((function(t){return o(l,{"data-testid":"".concat("AssetResultSection","_item_").concat(t.name,"MenuItem"),button:!0,classes:{gutters:y.listGutters},disabled:!t.redirectAssetId,onClick:function(){return T(t)},children:o(c,{primary:t.name,classes:{root:y.assetItemTextRoot,primary:y.assetItemTextPrimary}})},"item-".concat(u,"-").concat(e(t,"asset_id")?e(t,"asset_id"):e(t,"id")))}))]})},"section-".concat(u))}))}),b&&o(u,{"data-testid":"".concat("AssetResultSection","_loading"),className:y.loadingInfo,children:"Loading..."})]})};b.propTypes={page:g.number.isRequired,loading:g.bool.isRequired,groupedAssets:g.arrayOf(g.array).isRequired,onClickAsset:g.func.isRequired,onScrollReached:g.func.isRequired};export default b;
