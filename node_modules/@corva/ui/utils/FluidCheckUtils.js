import t from"@babel/runtime/helpers/defineProperty";import i from"moment";import{convertValue as r,getUnitPreference as e}from"./convert.js";import s from"lodash/get";import a from"lodash/isNumber";function n(t,i){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(t);i&&(e=e.filter((function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable}))),r.push.apply(r,e)}return r}function o(i){for(var r=1;r<arguments.length;r++){var e=null!=arguments[r]?arguments[r]:{};r%2?n(Object(e),!0).forEach((function(r){t(i,r,e[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(e)):n(Object(e)).forEach((function(t){Object.defineProperty(i,t,Object.getOwnPropertyDescriptor(e,t))}))}return i}function d(t){return 0!==t&&!t}function p(t,i,r,e){return this.isValueEmpty(t)?!!e:a(t)&&t>i&&t<r}function c(t,i,e){return a(t)?i&&e?parseFloat(r(t,i,e)):parseFloat(t):null}function u(t,i,s){return a(t)?i&&s?r(t,i,e(i),s):parseFloat(t):null}function l(t){var i=this.ctop(s(t,["data","mud_density"]),"density","ppg"),r=this.ctop(s(t,["data","depth"]),"length","ft"),e=this.ctop(s(t,["data","viscosity","yp"]),"yp","hsf");return o(o({},t),{},{data:o(o({},t.data),{},{mud_density:i,depth:r,viscosity:o(o({},t.data.viscosity),{},{yp:e})})})}function y(t){var i=this.ctoi(s(t,["data","mud_density"]),"density","ppg"),r=this.ctoi(s(t,["data","depth"]),"length","ft"),e=this.ctoi(s(t,["data","viscosity","yp"]),"yp","hsf");return o(o({},t),{},{data:o(o({},t.data),{},{mud_density:i,depth:r,viscosity:o(o({},t.data.viscosity),{},{yp:e}),date_str:null})})}function h(t){var r=t.data,e=r.date_str,s=r.mud_density,a=r.viscosity,n=a.pv,o=a.yp,d=a.rpm_readings,p=!1,c={viscosity:{rpm_readings:[]}};e&&!i(new Date(e)).isValid()&&(p=!0,c.date="Invalid Date.");var u=this.ctop(5,"density","ppg"),l=this.ctop(20,"density","ppg");this.isValueValid(s,u,l,!1)||(p=!0,c.mud_density="It should be ".concat(u," ~ ").concat(l)),(this.isValueEmpty(n)||this.isValueEmpty(o))&&d.length<2&&(p=!0,c.viscosity.rpm_readings_required="At least 2 paris of rpm and dial_reading required."),this.isValueValid(n,0,200,!c.viscosity.rpm_readings_required)||(p=!0,c.viscosity.pv="It should be 0~200"),this.isValueValid(o,0,200,!c.viscosity.rpm_readings_required)||(p=!0,c.viscosity.yp="It should be 0~200");for(var y=[],h=0;h<d.length;h+=1){c.viscosity.rpm_readings[h]={};var m=c.viscosity.rpm_readings[h];this.isValueValid(d[h].rpm,0,1e3)||(p=!0,m.rpm="It should be 0~1000"),this.isValueValid(d[h].dial_reading,0,300)||(p=!0,m.dial_reading="It should be 0~300"),-1!==y.indexOf(d[h].rpm)&&(p=!0,m.rpm="Duplicated RPM value"),y.push(d[h].rpm),d[h].originalIndex=h}var f=d.sort((function(t,i){return t.rpm-i.rpm}));return f.forEach((function(t,i){var r=c.viscosity.rpm_readings[t.originalIndex];f[i-1]&&t.dial_reading<f[i-1].dial_reading&&(p=!0,r.dial_reading="Dial Readings should be in increasing order")})),{hasErrors:p,errors:c}}export{y as convertToImperialUnit,l as convertToPrefUnit,u as ctoi,c as ctop,d as isValueEmpty,p as isValueValid,h as validate};
