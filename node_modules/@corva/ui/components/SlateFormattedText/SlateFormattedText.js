import t from"@babel/runtime/helpers/defineProperty";import e from"@babel/runtime/helpers/toConsumableArray";import{every as r}from"lodash";import{jsx as n,jsxs as a}from"react/jsx-runtime";import{useMemo as o,useCallback as i}from"react";import l from"prop-types";import{withReact as c,Slate as p,Editable as s}from"slate-react";import{createEditor as d}from"slate";import{Element as f,Leaf as u}from"./RenderElements.js";import{slateFormattingTextUtils as m}from"./utils.js";function O(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function S(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?O(Object(n),!0).forEach((function(r){t(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var x=function(t){var l,O=t.text,x=t.textsList,y=t.defaultText,b=t.defaultRenderingTextNode,g=t.locator,h="".concat(g,"_slateText"),T=o((function(){return c(d())}),[]),j=i((function(t){return n(f,S({},t))}),[]),N=i((function(t){return n(u,S({},t))}),[]),v=o((function(){var t=m.getValidSlateJSON(O),n=t.isTextValidSlateJSON,a=t.parsedJSON;if(x.length){var o=x.map((function(t){return m.getValidSlateJSON(t)}));n=r(o,(function(t){return t.isTextValidSlateJSON})),a=m.getDefaultParagraphObjectEmpty(),n&&o.forEach((function(t){var r,n=t.parsedJSON;m.isSlateTextEmpty(n)||(a[0].children=(r=a[0].children).concat.apply(r,e(n.map((function(t){return t.children})))));a[0].children=a[0].children.concat({text:"\n"})}))}var i=n&&m.isSlateTextEmpty(a);return{isValidSlateJSON:n,parsedSlateJSON:a,isEmptySlateJSON:i}}),[O,String(x)]),J=v.isValidSlateJSON,E=v.parsedSlateJSON,P=v.isEmptySlateJSON,V=m.getFormattedText({isValid:J,isEmpty:P,text:O,parsedText:E,defaultText:y});return l=x.length>0?x.map((function(t){return a("span",{"data-testid":"".concat(h,"_listItem"),children:[t,n("br",{})]},t)})):J&&P||!b?V:b,J&&!P?n(p,{editor:T,value:V,children:n(s,{"data-testid":"".concat(h,"_editable"),renderElement:j,renderLeaf:N,readOnly:!0})}):l};x.propTypes={text:l.string,textsList:l.arrayOf(l.string),defaultText:l.oneOfType([l.string,l.node]),defaultRenderingTextNode:l.node,locator:l.string},x.defaultProps={text:"",textsList:[],defaultText:"",defaultRenderingTextNode:void 0,locator:"SlateFormattedText"};export default x;
