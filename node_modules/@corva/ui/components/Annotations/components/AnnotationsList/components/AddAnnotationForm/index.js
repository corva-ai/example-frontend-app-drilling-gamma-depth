import e from"@babel/runtime/helpers/defineProperty";import"@babel/runtime/helpers/toConsumableArray";import"../../../../../../constants/completion.js";import t from"moment";import"../../../../../../constants/alerts.js";import{flowRight as r,get as o}from"lodash";import i from"@babel/runtime/helpers/slicedToArray";import"../../../../../../constants/goals.js";import"../../../../../../constants/segment.js";import"../../../../../../constants/apps.js";import"../../../../../../constants/drillstring.js";import"../../../../../../constants/notifications.js";import n from"@babel/runtime/regenerator";import s from"@babel/runtime/helpers/asyncToGenerator";import"../../../../../../utils/mobileDetect.js";import{showSuccessNotification as p,showErrorNotification as a}from"../../../../../../utils/notificationToasts.js";import"@babel/runtime/helpers/typeof";import"../../../../../../utils/index.js";import{jsxs as m,jsx as d}from"react/jsx-runtime";import{Fade as l,Paper as c,Typography as j}from"@material-ui/core";import{memo as u,useState as C,useRef as A}from"react";import"querystring";import"uuid/v1";import{postAnnotation as v}from"../../../../../../clients/jsonApi/index.js";import"../../../../../../clients/subscriptions.js";import D from"../../../../../../effects/useOutsideClick.js";import"uuid";import{number as f,shape as g,string as x}from"prop-types";import S from"classnames";import"../../../../../Modal/index.js";import"../../../../../IconMenu/index.js";import"../../../../../StyledMenuItem/index.js";import{withStyles as b}from"@material-ui/core/styles";import"../../../../../LoadingIndicator/LoadingIndicator.js";import"../../../../../DevCenter/DevCenterAppContainer/components/AppActions/AppActions.css.js";import"../../../../../EmptyView/EmptyAppView/EmptyAppView.js";import"../../../../../ErrorBoundary/ErrorBoundary.js";import"../../../../../Typography.js";import"../../../../../ErrorBoundary/DevCenterAppErrorView/DevCenterAppErrorView.js";import"../../../../../ConfirmationDialog.js";import"../../../../../DevCenter/DevCenterAppContainer/components/DisabledSettingsMessage/DisabledSettingsMessage.js";import"slate";import"../../../../../SlateFormattedText/RenderElements.js";import"../../../../../SlateFormattedText/SlateFormattedText.js";import"../../../../../DevCenter/DevCenterAppContainer/components/AppSettingsDialog/AppSettingsDialog.js";import"../../../../../DevCenter/DevCenterAppContainer/components/AnnotationsButton/AnnotationsButton.js";import"../../../../../DevCenter/DevCenterAppContainer/components/NonPriorityMenus/NonPriorityMenus.js";import"../../../../../DevCenter/DevCenterAppContainer/components/FullscreenButton/FullscreenButton.js";import"../../../../../DevCenter/DevCenterAppContainer/components/AppInfoMessage/AppInfoMessage.js";import"../../../../../EmptyView/EmptyAppView/components/ErrorSubtitleWithIntercomLink.js";import"../../../../../DevCenter/DevCenterAppContainer/components/HelpCenterDialog/HelpCenterDialog.js";import"../../../../../DevCenter/DevCenterAppContainer/components/DcTooltipsCoordinatorProvider/DcTooltipsCoordinatorProvider.js";import"../../../../../DevCenter/DevCenterAppContainer/components/IsInsideDcAppProvider/IsInsideDcAppProvider.js";import"../../../../../Tooltip/MuiTooltipDcWrapper.js";import y from"../../../../../Avatar/index.js";import{ADD_ANNOTATION as P}from"../../../../constants.js";import{useAnnotationsDispatch as h}from"../../../../AnnotationsContext.js";import"../../../../../DevCenter/DevCenterRouterContext/DevCenterRouterContext.js";import"../../../../../DevCenter/DevCenterRouterContext/UniversalLink/UniversalLink.js";import{withUniversalLocationHOC as I}from"../../../../../DevCenter/DevCenterRouterContext/hocs/withUniversalLocationHOC.js";import T from"../AnnotationInput/index.js";import L from"./style.css.js";import"../../index.js";import"../../../LastAnnotation/index.js";import"../../../../../PadModeSelect/PadModeSelect.js";import"../../../../../DevCenter/AppHeader/AppHeader.js";import"../../../../../DevCenter/AppSideBar/AppSideBar.js";import"../../../../../DevCenter/AppContext.js";import"../../../../../DevCenter/AppsDataProvider/AppsDataProvider.js";import"@material-ui/icons/Help";import"../../../../../DevCenter/DevCenterAppContainer/DevCenterAppContainer.css.js";import"../../../../../DevCenter/DevCenterAppContainer/components/RestoreAppSizeButton/index.js";import"../../../../../DevCenter/DevCenterAppContainer/components/PriorityMenus/PriorityMenus.css.js";import"../../../../../DevCenter/NavigationBar/NavigationBar.js";import"../../../../../DevCenter/SideBar/SideBar.js";import"../../../../../DevCenter/AppSettingsPopover/AppSettingsPopover.js";import"../../../../../TruncatedText/index.js";import"../../../../../AssetEditor/SingleAssetEditor.js";import"../../../../../AssetEditor/AssetEditorAutocomplete.js";import"../../../../../AssetEditor/index.js";import"../../../../../AppVersionsSelect/AppVersionsSelect.js";import"../../../../../CollapsableSidebar.js";import"../../../../../DateTimePicker/index.js";import"../../../../../DatePicker/index.js";import"../../../../../ColorPicker/PaletteChromePicker/PaletteChromePicker.js";import"../../../../../ColorPicker/ColorPicker.js";import"../../../../../ParameterCharts/AddEditTrack.js";import"../../../../../ParameterCharts/ParameterCharts.js";import"../../../../../ChartActionsList/ChartActionsList.js";import"../../../../../SettingEditors/ColorEditor/index.js";import"../../../../../SettingEditors/DropdownEditor/index.js";import"../../../../../SettingEditors/RadioEditor/index.js";import"../../../../../SwitchControl/index.js";import"../../../../../RangeSlider/RangeSlider.js";import"../../../../../Login/components/Login.js";import"../../../../../Login/components/PasswordField.js";import"../../../../../Login/components/Chip.js";import"../../../../../Login/components/StepFooter.js";import"../../../../../Login/components/StepContent.js";import"../../../../../Login/components/StepHeader.js";import"../../../../../Login/components/Step.js";import"../../../../../Login/components/OrDivider.js";import"../../../../../Login/components/HiddenEmailField.js";import"../../../../../Login/components/EmailField.js";import"../../../../../Breadcrumbs/index.js";import"../../../../../VirtualizedTable/index.js";import"../../../../../EmptyView/EmptyView.js";import"../../../../../Button/index.js";import"../../../../../MenuItem/index.js";import"../../../../../ContextMenuItem/index.js";import"../../../../../FolderMenuItem/index.js";import"../../../../../EditableItem/EditableItem/index.js";import"../../../../../EditableItem/EditableItemWithBadge/index.js";import"../../../../../Checkbox/index.js";import"../../../../../FolderMenuItemWithLinks/index.js";import"../../../../../IconButton/index.js";import"../../../../../TextField/index.js";import"../../../../../Chip/index.js";import"../../../../../Counter/index.js";import"../../../../../AnchorsList/AnchorsList.js";import"../../../../../Select/index.js";import"../../../../../Tabs/Tabs.js";import"../../../../../Tabs/Tab.js";import"../../../../../Drillstring/BHASchematic.js";import"../../../../../Drillstring/BHAComponentIcon.js";import"../../../../../Drillstring/BHATable/index.js";import"../../../../../Drillstring/BHAComponentDetail/index.js";import"../../../../../Casing/CasingComponentIcon.js";import"../../../../../Casing/CasingTable/index.js";import"../../../../../WellSummary/WellSummaryItemLabel.js";import"../../../../../WellSummary/WellSummaryItemTitle.js";import"../../../../../WellSummary/WellSummaryItemValue.js";import"../../../../../WellSummary/ActivitySummaryChart.js";import"../../../../../WellSummary/FracWirelineTimeChart.js";import"../../../../../BICOffsetPickerDialog/index.js";import"../../../../../OffsetWellPickerV2/OffsetWellPickerDialog.js";import"../../../../../Notifications/Notifications.js";import"../../../../../TextLink/index.js";import"../../../../../Template/TemplatePopover/index.js";import"../../../../../PinnableFilters/PinnableFilters.js";import"../../../../../HeaderLayout/HeaderLayout.js";import"../../../../../PadOffsetsPicker/PadOffsetsPicker.js";import"../../../../../PadOffsetsPicker/OffsetAssetChip.js";import"../../../../../PadOffsetsPicker/OffsetAssetsListExpander.js";import"../../../../../PadOffsetsPicker/StagesSelector.js";import"../../../../../Table/TableToolbar/TableToolbar.js";import"../../../../../PriceInput/PriceInput.js";import"../../../../../LabelsCounter/LabelsCounter.js";import"../../../../../Stepper/Step.js";import"../../../../../Stepper/StepsWrapper.js";import"../../../../../Stepper/Stepper.js";import"../../../../../Comment/CommentIcon/index.js";import"../../../../../FilesLoader/FilesLoader.js";import"../../../../../SearchInput/index.js";var E=function(r){var u,f=r.appId,g=r.assetId,x=r.assetCompanyId,b=r.appSettings,I=r.currentUser,E=r.classes,k=r.location,B=r.dashboardType,F=h(),M=C(!1),W=i(M,2),w=W[0],R=W[1],H=A(null);D(H,(function(){R(!1)}));var O,V=(O=s(n.mark((function e(r,i,s){var m,d,l,c;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,m={app_id:f,asset_id:g,body:r,active_until:i,attachment:{file_name:s&&s.attachmentName,s3_link:s&&s.attachmentUrl},settings:b},d={},B&&(d.dashboard_type=B),(l=o(k,"query.time"))&&(m.data_timestamp=t(l).format()),e.next=8,v(m,d);case 8:c=e.sent,F({type:P,annotation:c}),e.next=17;break;case 12:return e.prev=12,e.t0=e.catch(0),a("Error during annotation creation"),console.error(e.t0),e.abrupt("return");case 17:p("Annotation has been added"),R(!1);case 19:case"end":return e.stop()}}),e,null,[[0,12]])}))),function(e,t,r){return O.apply(this,arguments)});return m("div",{className:L.cAddAnnotationFormInput,children:[d(y,{displayName:"".concat(I.first_name," ").concat(I.last_name),imgSrc:I.profile_photo,size:36}),m("div",{className:S(L.cAddAnnotationFormInputPaper,(u={},e(u,L.cAddAnnotationFormInputPaperOpened,w),e(u,L.cAddAnnotationFormInputPaperClosed,!w),u)),children:[d(l,{in:!w,timeout:500,children:d(c,{className:L.cAddAnnotationFormInputPaperLabel,children:d(j,{variant:"body2","data-testid":"".concat("AppAnnotationsPo","_collapsedInput"),className:E.inputLabel,onClick:function(){return R(!0)},children:"Type annotation here"})})}),d(l,{in:w,timeout:100,children:d("div",{className:L.cAddAnnotationFormInputPaperAddAnnotation,children:w&&d(T,{onSend:V,assetCompanyId:x,currentUser:I})})})]})]})};E.propTypes={appId:f.isRequired,assetId:f.isRequired,assetCompanyId:f.isRequired,appSettings:g().isRequired,currentUser:g({}),classes:g().isRequired,location:g().isRequired,dashboardType:x},E.defaultProps={currentUser:{},dashboardType:null};var k=r([b((function(e){return{inputLabel:{color:e.palette.grey[700],fontWeight:200,width:"100%"}}})),I])(u(E));export default k;
