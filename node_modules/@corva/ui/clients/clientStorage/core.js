import e from"moment";import r from"lodash/get";import t from"lodash/set";import a from"lodash/unset";var o=function(e){return e.expiry?e.value:e};function i(e){if("string"==typeof e)localStorage.removeItem(e);else if(Array.isArray(e)&&e.length){var r=JSON.parse(localStorage.getItem(e[0]));a(r,e.slice(1)),localStorage.setItem(e[0],JSON.stringify(r))}}function l(r,a){var i,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3?arguments[3]:void 0,g=l&&l.length?{value:a,expiry:e().add(l[0],l[1])}:a;if("string"==typeof r?(i=g,localStorage.setItem(r,JSON.stringify(i))):Array.isArray(r)&&r.length&&(i=JSON.parse(localStorage.getItem(r[0]))||{},t(i,r.slice(1),g),localStorage.setItem(r[0],JSON.stringify(i))),i&&"function"==typeof n){var s=o(i);n(s)}}var n=function(r,t){var a=r;return Array.isArray(r)?(l(t,a=r.filter((function(r){return!r.expiry||e().diff(r.expiry)<0}))),a.map((function(e){return e.value}))):(r&&r.expiry&&e().diff(r.expiry)>0&&(i(t),a=void 0),a)};function g(e){var t,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if("string"==typeof e)t=JSON.parse(localStorage.getItem(e));else if(Array.isArray(e)&&e.length){var o=JSON.parse(localStorage.getItem(e[0]));t=r(o,e.slice(1))}var i=n(t,e);return void 0!==i?i:a}function s(a,i){var l,n,g=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=arguments.length>3?arguments[3]:void 0,f=g&&g.length?{value:i,expiry:e().add(g[0],g[1])}:i;if("string"==typeof a?((n=JSON.parse(localStorage.getItem(a))||[]).push(f),localStorage.setItem(a,n)):Array.isArray(a)&&a.length&&(l=JSON.parse(localStorage.getItem(a[0]))||{},(n=r(l,a.slice(1),[])).push(f),t(l,a.slice(1),n),localStorage.setItem(a[0],JSON.stringify(l))),n&&"function"==typeof s){var c=n.map((function(e){return o(e)}));s(c)}}export{i as deleteValue,g as getValue,s as pushValue,l as setValue};
