import e from"@babel/runtime/helpers/defineProperty";import t from"moment";import{MIN_ID as r,MAX_ID as n,MIN_OD as i,MAX_OD as o,MIN_TOP_DEPTH as a,MAX_TOP_DEPTH as h,MIN_BOTTOM_DEPTH as l,MAX_BOTTOM_DEPTH as m,DP_MIN_ID as s,DP_MIN_OD as u,DP_MAX_ID as _,DP_MAX_OD as d,DP_MIN_TJ_ID as g,DP_MIN_TJ_OD as p,DP_MAX_TJ_ID as f,DP_MAX_TJ_OD as c,DP_MIN_LENGTH as b,DP_MAX_LENGTH as j,HWDP_MIN_ID as O,HWDP_MIN_OD as F,HWDP_MAX_ID as w,HWDP_MAX_OD as y,HWDP_MIN_TJ_ID as L,HWDP_MIN_TJ_OD as v,HWDP_MAX_TJ_ID as D,HWDP_MAX_TJ_OD as I,HWDP_MIN_LENGTH as N,HWDP_MAX_LENGTH as P}from"../../constants/casing.js";import{getUnitDisplay as V,getUnitPreference as q,convertValue as k}from"../convert.js";function x(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function A(t){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?x(Object(n),!0).forEach((function(r){e(t,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var S=V("shortLength"),T=V("length");function E(e,t,r,n){var i=r?e.toFixed(r):e,o=r?t.toFixed(r):t;return"".concat(i,"~").concat(o).concat(n?" (".concat(n,")"):"")}function J(e,t,r){return!(Number.isFinite(e)&&Number.isFinite(t)&&Number.isFinite(r))||(e<t||e>r)}function B(e,t){var r=q("shortLength"),n="in"!==r?k(e,"shortLength",r,"in"):e,i="in"!==r?k(t,"shortLength",r,"in"):t,o=2.673*(n*n-i*i);return"in"!==r?k(o,"massPerLength","lb-ft"):o}function C(e,t,r){var n=B(e,t);return r>=.5*n&&r<=1.5*n}function W(e){var t=function(e){return A(A({},e),{},{inner_diameter:parseFloat(e.inner_diameter),outer_diameter:parseFloat(e.outer_diameter),linear_weight:parseFloat(e.linear_weight),number_of_joints:parseFloat(e.number_of_joints),component_length:parseFloat(e.component_length),length:parseFloat(e.length),weight:parseFloat(e.weight),outer_diameter_tooljoint:parseFloat(e.outer_diameter_tooljoint),inner_diameter_tooljoint:parseFloat(e.inner_diameter_tooljoint),length_tooljoint:parseFloat(e.length_tooljoint)})}(e),r=A(A({},function(e){var t={};return Number.isFinite(e.inner_diameter)||(t.inner_diameter="It must be a number."),Number.isFinite(e.outer_diameter)||(t.outer_diameter="It must be a number."),Number.isFinite(e.linear_weight)||(t.linear_weight="It must be a number."),t.inner_diameter||t.outer_diameter||(e.outer_diameter<e.inner_diameter?t.outer_diameter="O.D > I.D":t.linear_weight||C(e.outer_diameter,e.inner_diameter,e.linear_weight)||(t.linear_weight="Invalid linear weight")),Number.isFinite(e.number_of_joints)||(t.number_of_joints="It must be a number."),Number.isFinite(e.component_length)||(t.component_length="It must be a number."),Number.isFinite(e.length)||(t.length="It must be a number."),Number.isFinite(e.weight)||(t.weight="It must be a number."),t}(t)),function(e){var t,r,n,i,o,a,h,l,m,V,q=e.family,x={};return"dp"!==q&&"hwdp"!==q||("dp"===q?(t=s,r=u,n=_,i=d,o=g,a=p,h=f,l=c,m=b,V=j):(t=O,r=F,n=w,i=y,o=L,a=v,h=D,l=I,m=N,V=P),t=k(t,"shortLength","in"),r=k(r,"shortLength","in"),n=k(n,"shortLength","in"),i=k(i,"shortLength","in"),o=k(o,"shortLength","in"),a=k(a,"shortLength","in"),h=k(h,"shortLength","in"),l=k(l,"shortLength","in"),m=k(m,"length","ft"),V=k(V,"length","ft"),J(e.inner_diameter,t,n)&&(x.inner_diameter=E(t,n,2,S)),J(e.outer_diameter,r,i)&&(x.outer_diameter=E(r,i,2,S)),J(e.inner_diameter_tooljoint,o,h)&&(x.inner_diameter_tooljoint=E(o,h,2,S)),J(e.outer_diameter_tooljoint,a,l)&&(x.outer_diameter_tooljoint=E(a,l,2,S)),J(e.length,m,V)&&(x.length=E(m,V,2,T)),!x.outer_diameter_tooljoint&&e.outer_diameter_tooljoint<e.outer_diameter&&(x.outer_diameter_tooljoint="Tool Joint O.D >= O.D"),e.length_tooljoint>e.component_length&&(x.length_tooljoint="Tool Joint Length < Component Length")),x}(t));return Object.keys(r).length>0?{isValid:!1,errors:r}:{isValid:!0}}function z(e,t){var r=[];if(t.length&&!e){var n=t.filter((function(e){return"casing_joints"===e.family})),i=t.filter((function(e){return"float_shoe"===e.family})),o=t[t.length-1],a=t[0];n.length<1&&r.push("At least one casing joints required."),0===i.length?r.push("At least one float shoe required."):i.length>1?r.push("Only one float shoe required."):"float_shoe"!==a.family&&"float_shoe"!==o.family&&r.push("Float Shoe should be on the bottom of the list")}if(e){var h=t.filter((function(e){return"riser"===e.family}));0===h.length?r.push("At least one riser required."):h.length>1&&r.push("Only one riser required.")}return r.length>0?{isValid:!1,errors:r}:{isValid:!0}}function G(e){var s=e.data,u={},_=k(r,"shortLength","in"),d=k(n,"shortLength","in"),g=k(i,"shortLength","in"),p=k(o,"shortLength","in"),f=k(a,"length","ft"),c=k(h,"length","ft"),b=k(l,"length","ft"),j=k(m,"length","ft");return s.start_timestamp&&!t(new Date(s.start_timestamp)).isValid()&&(u.start_timestamp="Invalid Date."),J(s.inner_diameter,_,d)&&(u.inner_diameter=E(_,d,2,S)),J(s.outer_diameter,g,p)&&(u.outer_diameter=E(g,p,2,S)),!u.inner_diameter&&!u.outer_diamter&&s.inner_diamter>s.outer_diameter&&(u.outer_diameter="O.D > I.D"),J(s.top_depth,f,c)&&(u.top_depth=E(f,c,2,T)),J(s.bottom_depth,b,j)&&(u.bottom_depth=E(b,j,2,T)),!u.top_depth&&!u.bottom_depth&&s.top_depth>s.bottom_depth&&(u.bottom_depth="Bottom Depth > Top Depth"),u.inner_diameter||u.outer_diameter||!C(s.outer_diameter,s.inner_diameter,s.linear_weight)||(u.linear_weight="Invalid Linear Weight"),Object.keys(u).length>0?{isValid:!1,errors:u}:{isValid:!0}}export{B as calculateLinearWeight,C as isValidLinearWeight,W as validateComponent,z as validateInterComponents,G as validateMainFields};
