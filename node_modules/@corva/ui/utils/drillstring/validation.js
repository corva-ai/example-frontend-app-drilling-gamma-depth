import e from"@babel/runtime/helpers/defineProperty";import t from"moment";import{isEmpty as r,maxBy as n,omit as i}from"lodash";import{convertValue as o,getUnitPreference as s,getUnitDisplay as a}from"../convert.js";function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _(t){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?l(Object(n),!0).forEach((function(r){e(t,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var d={general:{empty:"It should not be empty."}},u={general:{family:"Family should be matched."}};function m(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2;return null==e?null:t&&r?parseFloat(o(e,t,s(t),r,n)):parseFloat(e)}function h(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2;return 0===e||e?t&&r?o(e,t,r,null,n):e:null}function c(e){return null==e||""===e}function g(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=n.isMinInclusive,o=void 0===i||i,s=parseFloat(e);return!Number.isNaN(s)&&(!(o&&s<t||!o&&s<=t)&&!(r&&s>r))}function f(e,t,r){var n=s("shortLength"),i=e,a=t;"in"!==n&&(i=o(e,"shortLength",n,"in"),a=o(t,"shortLength",n,"in"));var l=2.673*(a*a-i*i),_="in"!==n?o(l,"massPerLength","lb-ft"):l;return r>=.5*_&&r<=1.5*_}function p(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!e||!t)return d;var n=t.min_id,i=t.min_od,s=t.max_id,l=t.max_od,_=t.min_length,u=t.min_tj_id,m=t.max_tj_id,h=t.min_tj_od,f=t.max_tj_od,p=t.min_pressure_loss,v=t.min_off_bottom_pressure_loss,b=a("shortLength"),L={},x=!1;if(c(n)||c(i)||(g(e.inner_diameter,n,s)||(L.inner_diameter="".concat(n.toFixed(1),"~").concat(s.toFixed(1)," (").concat(b,")"),x=!0),g(e.outer_diameter,i,l)||(L.outer_diameter="".concat(i.toFixed(1),"~").concat(l.toFixed(1)," (").concat(b,")"),x=!0),g(e.inner_diameter,n,s)&&g(e.outer_diameter,i,l)&&!g(e.inner_diameter,n,e.outer_diameter)&&(L.outer_diameter="O.D > I.D",x=!0),!L.outer_diameter&&r&&+e.outer_diameter+o(.1,"shortLength","in")>r&&(L.outer_diameter=" O.D + 0.1 < Bit Size",x=!0),g(e.linear_weight,0)||(L.linear_weight="Invalid value",x=!0)),c(u)||c(h)||(g(e.inner_diameter_tooljoint,u,m)||(L.inner_diameter_tooljoint="".concat(u.toFixed(1),"~").concat(m.toFixed(1)," (").concat(b,")"),x=!0),g(e.outer_diameter_tooljoint,h,f)||(L.outer_diameter_tooljoint="".concat(h.toFixed(1),"~").concat(f.toFixed(1)," (").concat(b,")"),x=!0),g(e.outer_diameter_tooljoint,e.outer_diameter,f)||(L.outer_diameter_tooljoint="Tool Joint O.D >= O.D",x=!0)),c(_)||g(e.length,_)||(L.length="Invalid value",x=!0),c(e.length_tooljoint)||c(e.component_length)||+e.length_tooljoint>+e.component_length&&(L.length_tooljoint="Tool Joint Length < Component Length",x=!0),e.off_bottom_pressure_loss&&e.off_bottom_pressure_loss.length>0){L.off_bottom_pressure_loss={};for(var w=0;w<e.off_bottom_pressure_loss.length;w+=1){var y=e.off_bottom_pressure_loss[w];L.off_bottom_pressure_loss[w]={},c(y.flow_rate)&&(L.off_bottom_pressure_loss[w].flow_rate="flow rate is required.",x=!0),c(y.pressure_loss)&&(L.off_bottom_pressure_loss[w].pressure_loss="pressure loss is required.",x=!0),c(v)||g(y.pressure_loss,v,null,{isMinInclusive:!1})||(L.off_bottom_pressure_loss[w].pressure_loss="Invalid range",x=!0)}}if(e.pressure_loss&&e.pressure_loss.length>0){L.pressure_loss={};for(var F=0;F<e.pressure_loss.length;F+=1){var j=e.pressure_loss[F];L.pressure_loss[F]={},c(j.flow_rate)&&(L.pressure_loss[F].flow_rate="flow rate is required.",x=!0),c(j.pressure_loss)&&(L.pressure_loss[F].pressure_loss="pressure loss is required.",x=!0),c(p)||g(j.pressure_loss,p,null,{isMinInclusive:!1})||(L.pressure_loss[F].pressure_loss="Invalid range",x=!0)}}if(e.has_stabilizer&&e.stabilizer){var I=o(0,"shortLength","in"),z=o(100,"shortLength","in"),O=o(1,"shortLength","in"),q=o(100,"shortLength","in"),D=o(0,"length","ft");g(e.stabilizer.inner_diameter,I,z)&&g(e.stabilizer.outer_diameter,O,q)&&!g(e.stabilizer.inner_diameter,n,e.stabilizer.outer_diameter)&&(L.stabilizer_outer_diameter="O.D > I.D",x=!0),g(e.stabilizer.inner_diameter,I,z)||(L.stabilizer_inner_diameter="".concat(I.toFixed(1),"~").concat(z.toFixed(1)," (").concat(b,")"),x=!0),g(e.stabilizer.outer_diameter,O,q)||(L.stabilizer_outer_diameter="".concat(O.toFixed(1),"~").concat(q.toFixed(1)," (").concat(b,")"),x=!0),c(D)||g(e.stabilizer.length,D)||(L.stabilizer_length="Invalid value",x=!0),c(e.stabilizer.linear_weight)&&(L.stabilizer_linear_weight="Invalid value",x=!0),!L.stabilizer_outer_diameter&&r&&+e.stabilizer.outer_diameter+o(.1,"shortLength","in")>r&&(L.stabilizer_outer_diameter=" O.D + 0.1 < Bit Size",x=!0)}return x?L:null}function v(e){if(!e)return d;var n=a("length"),i={};if(c(e.id)&&(i.id="It should not be empty."),e.start_timestamp_str&&!t(new Date(e.start_timestamp_str)).isValid()&&(i.start_timestamp="Invalid Date."),Number.isFinite(e.start_depth)){var s=o(0,"length","ft"),l=o(55e3,"length","ft"),_=o(1,"length","ft");(e.start_depth<=s||e.start_depth>l)&&(i.start_depth="Should be a positive number ".concat(s.toFixed(2),"~").concat(l.toFixed(2)," (").concat(n,")")),e.start_depth===_&&(i.start_depth="Should not be equal to ".concat(_," (").concat(n,")"))}else i.start_depth="It should not be empty.";return r(i)?null:i}function b(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!t)return d;var i={min_id:o(0,"shortLength","in"),max_id:o(100,"shortLength","in"),min_od:o(1,"shortLength","in"),max_od:o(100,"shortLength","in"),min_length:o(0,"length","ft")},s=p(t,i,n),a=s||{},l={general:{},components:e({},t.id,a),specificErrors:{}};return r(a)?null:l}function L(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!t)return d;if("dp"!==t.family)return u;var i={min_id:o(1,"shortLength","in"),max_id:o(7,"shortLength","in"),min_od:o(2,"shortLength","in"),max_od:o(8,"shortLength","in"),min_tj_id:o(1,"shortLength","in"),max_tj_id:o(7,"shortLength","in"),min_tj_od:o(2,"shortLength","in"),max_tj_od:o(10,"shortLength","in"),min_length:o(0,"length","ft")},s=p(t,i,n),a=s||{};a.inner_diameter||a.outer_diameter||a.linear_weight||f(t.inner_diameter,t.outer_diameter,t.linear_weight)||(a.linear_weight="Invalid range");var l={general:{},components:e({},t.id,a),specificErrors:{}};return r(a)?null:l}function x(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!t)return d;if("hwdp"!==t.family)return u;var i={min_id:o(1,"shortLength","in"),max_id:o(7,"shortLength","in"),min_od:o(2,"shortLength","in"),max_od:o(8,"shortLength","in"),min_tj_id:o(1,"shortLength","in"),max_tj_id:o(7,"shortLength","in"),min_tj_od:o(2,"shortLength","in"),max_tj_od:o(10,"shortLength","in"),min_length:o(0,"length","ft")},s=p(t,i,n),a=s||{};a.inner_diameter||a.outer_diameter||a.linear_weight||f(t.inner_diameter,t.outer_diameter,t.linear_weight)||(a.linear_weight="Invalid range");var l={general:{},components:e({},t.id,a),specificErrors:{}};return r(a)?null:l}function w(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!t)return d;if("dc"!==t.family)return u;var i={min_id:o(.5,"shortLength","in"),max_id:o(7,"shortLength","in"),min_od:o(2,"shortLength","in"),max_od:o(13,"shortLength","in"),min_length:o(0,"length","ft")},s=p(t,i,n),a=s||{};a.inner_diameter||a.outer_diameter||a.linear_weight||f(t.inner_diameter,t.outer_diameter,t.linear_weight)||(a.linear_weight="Invalid range");var l={general:{},components:e({},t.id,a),specificErrors:{}};return r(a)?null:l}function y(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return e?"jar"!==e.family?u:b(e,t):d}function F(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return e?"sub"!==e.family?u:b(e,t):d}function j(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!t)return d;if("bit"!==t.family)return u;var i=t.size,s=p(t,{},i),a=s||{},l=h(1,"shortLength","in"),_=l*l*0,m=l*l*20;c(n)||c(i)||+n+o(.1,"shortLength","in")>i&&(a.size=" max(O.D) + 0.1 < Bit Size"),g(t.tfa,_,m)||(a.tfa="TFA must be ".concat(_.toFixed(2),"~").concat(20..toFixed(2)));var f={general:{},components:e({},t.id,a),specificErrors:{}};return r(a)?null:f}function I(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!t)return d;if("pdm"!==t.family)return u;var i,s,a={min_od:o(2,"shortLength","in"),max_od:o(15,"shortLength","in"),min_id:o(0,"shortLength","in"),max_id:o(12,"shortLength","in"),min_length:o(4,"length","ft"),min_off_bottom_pressure_loss:0},l=p(t,a,n),_=l||{};g(t.number_rotor_lobes,1,10)||(_.number_rotor_lobes="It must be ".concat(1,"~").concat(10)),g(t.number_stator_lobes,2,10)||(_.number_stator_lobes="It must be ".concat(2,"~").concat(10)),g(t.rpg,0,10)||(_.rpg="It must be ".concat(0,"~").concat(10)),i=o(0,"force","klbf"),s=o(200,"force","klbf"),c(t.max_weight_on_bit)||g(t.max_weight_on_bit,i,s)||(_.max_weight_on_bit="It must be ".concat(s.toFixed(2),"~").concat(s.toFixed(2))),i=o(0,"volumeFlowRate","gal/min"),s=o(2500,"volumeFlowRate","gal/min"),g(t.min_standard_flowrate,i,s)||(_.min_standard_flowrate="It must be ".concat(i.toFixed(2),"~").concat(s.toFixed(2))),g(t.max_standard_flowrate,i,s)||(_.max_standard_flowrate="It must be ".concat(i.toFixed(2),"~").concat(s.toFixed(2))),i=o(0,"pressure","psi"),s=o(3e3,"pressure","psi"),g(t.max_operating_differential_pressure,i,s)||(_.max_operating_differential_pressure="It must be ".concat(i.toFixed(2),"~").concat(s.toFixed(2))),i=o(0,"torque","ft-klbf"),s=o(40,"torque","ft-klbf"),g(t.torque_at_max_operating_differential_pressure,i,s)||(_.torque_at_max_operating_differential_pressure="It must be ".concat(i.toFixed(2),"~").concat(s.toFixed(2))),g(t.flow_loss_percentage,0,20)||(_.flow_loss_percentage="It must be ".concat(0,"~").concat(20));var m={general:{},components:e({},t.id,_),specificErrors:{}};return r(_)?null:m}function z(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!t)return d;if("lwd"!==t.family)return u;var n={min_od:o(2,"shortLength","in"),max_od:o(9.5,"shortLength","in"),min_id:o(.1,"shortLength","in"),max_id:o(7,"shortLength","in"),min_length:o(1,"length","ft")},i=p(t,n,r),s=i||{},a=!1;if(i&&(a=!0),t.lwd_measurements&&t.lwd_measurements.length>0){s.lwd_measurements={};for(var l=0;l<t.lwd_measurements.length;l+=1){var _=t.lwd_measurements[l];s.lwd_measurements[l]={},c(_.type)&&(s.lwd_measurements[l].type="measurement type is required.",a=!0),c(_.distance)&&(s.lwd_measurements[l].distance="measurement distance is required.",a=!0)}}var m={general:{},components:e({},t.id,s),specificErrors:{}};return t.lwd_measurements&&t.lwd_measurements.length||(m.general.lwd_measurements="LWD Tool requires at least one LWD measurement should be selected.",a=!0),a?m:null}function O(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!t)return d;if("stabilizer"!==t.family)return u;var i={min_id:o(0,"shortLength","in"),max_id:o(100,"shortLength","in"),min_od:o(1,"shortLength","in"),max_od:o(100,"shortLength","in"),min_length:o(0,"length","ft")},s=p(t,i,n),a=s||{},l={general:{},components:e({},t.id,a),specificErrors:{}};return r(a)?null:l}function q(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!t)return d;if("mwd"!==t.family)return u;var i={min_od:o(2,"shortLength","in"),max_od:o(13,"shortLength","in"),min_id:o(0,"shortLength","in"),max_id:o(12,"shortLength","in"),min_length:o(1,"length","ft"),min_pressure_loss:0},s=p(t,i,n),a=s||{};t.has_gamma_sensor&&!Number.isFinite(t.gamma_sensor_to_bit_distance)&&(a.gamma_sensor_to_bit_distance="This field is required."),t.has_survey_sensor&&!Number.isFinite(t.bit_to_survey_distance)?a.bit_to_survey_distance="This field is required.":t.has_survey_sensor&&t.bit_to_survey_distance<=0?a.bit_to_survey_distance="Should be a positive number.":t.has_survey_sensor&&t.bit_to_survey_distance>150&&(a.bit_to_survey_distance="Should be less then 150."),t.has_directional_sensor&&!Number.isFinite(t.directional_sensor_to_bit_distance)?a.directional_sensor_to_bit_distance="This field is required.":t.has_directional_sensor&&t.directional_sensor_to_bit_distance<=0?a.directional_sensor_to_bit_distance="Should be a positive number.":t.has_directional_sensor&&t.directional_sensor_to_bit_distance>150&&(a.directional_sensor_to_bit_distance="Should be less then 150.");var l={general:{},components:e({},t.id,a),specificErrors:{}};return r(a)?null:l}function D(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!t)return d;if("agitator"!==t.family)return u;var i={min_od:o(2,"shortLength","in"),max_od:o(13,"shortLength","in"),min_id:o(0,"shortLength","in"),max_id:o(12,"shortLength","in"),min_length:o(1,"length","ft"),min_pressure_loss:0},s=p(t,i,n),a=s||{},l={general:{},components:e({},t.id,a),specificErrors:{}};return r(a)?null:l}function E(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!t)return d;if("rss"!==t.family)return u;var i={min_od:o(2,"shortLength","in"),max_od:o(13,"shortLength","in"),min_id:o(0,"shortLength","in"),max_id:o(12,"shortLength","in"),min_length:o(1,"length","ft"),min_pressure_loss:0},s=p(t,i,n),a=s||{};g(t.flow_loss_percentage,0,10)||(a.flow_loss_percentage="It must be ".concat(0,"~").concat(10));var l={general:{},components:e({},t.id,a),specificErrors:{}};return r(a)?null:l}function T(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!t)return d;if("ct"!==t.family)return u;var i=a("shortLength"),s={min_id:o(0,"shortLength","in"),max_id:o(100,"shortLength","in"),min_od:o(1,"shortLength","in"),max_od:o(100,"shortLength","in"),min_length:o(0,"length","ft")},l=o(0,"shortLength","in"),_=o(500,"shortLength","in"),m=p(t,s,n),h=m||{};h.inner_diameter||h.outer_diameter||h.linear_weight||f(t.inner_diameter,t.outer_diameter,t.linear_weight)||(h.linear_weight="Invalid range"),g(t.reel_diameter,l,_)||(h.reel_diameter="".concat(l.toFixed(1),"~").concat(_.toFixed(1)," (").concat(i,")"));var c={general:{},components:e({},t.id,h),specificErrors:{}};return r(h)?null:c}function S(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!t)return d;if("ur"!==t.family)return u;var i=a("shortLength"),s={min_id:o(0,"shortLength","in"),max_id:o(50,"shortLength","in"),min_od:o(1,"shortLength","in"),max_od:o(50,"shortLength","in")},l=o(1,"shortLength","in"),_=o(50,"shortLength","in"),m=p(t,s,n),c=m||{};c.inner_diameter||c.outer_diameter||c.linear_weight||f(t.inner_diameter,t.outer_diameter,t.linear_weight)||(c.linear_weight="Invalid range"),g(t.ur_opened_od,l,_)?t.ur_opened_od<n&&(c.ur_opened_od="Max O.D (Opened) >= Bit Size"):c.ur_opened_od="".concat(l.toFixed(1),"~").concat(_.toFixed(1)," (").concat(i,")"),Number.isFinite(t.flow_rate)||(c.flow_rate="This field is required."),"depth_activation"!==t.activation_logic||Number.isFinite(t.ur_opened_depth)||(c.ur_opened_depth="This field is required."),t.activation_logic||(c.activation_logic="This field is required.");var v=h(1,"shortLength","in"),b=v*v*0,L=v*v*20;g(t.tfa,b,L)||(c.tfa="TFA must be ".concat(b.toFixed(2),"~").concat(20..toFixed(2)));var x={general:{},components:e({},t.id,c),specificErrors:{}};return r(c)?null:x}function N(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!e)return d;switch(e.family){case"dp":return L(e,t);case"hwdp":return x(e,t);case"dc":return w(e,t);case"jar":return y(e,t);case"sub":return F(e,t);case"bit":return j(e,r);case"pdm":return I(e,t);case"lwd":return z(e,t);case"stabilizer":return O(e,t);case"mwd":return q(e,t);case"agitator":return D(e,t);case"rss":return E(e,t);case"ct":return T(e,t);case"ur":return S(e,t);default:return b(e,t)}}function P(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!e)return d;for(var o=e.filter((function(e){return"bit"===e.family})),s=o&&(o.length>0?o[0].size:null),a=null===(t=n(e,"outer_diameter"))||void 0===t?void 0:t.outer_diameter,l=e.filter((function(e){return"mwd"===e.family&&e.has_gamma_sensor})),u=!1,m={general:{},components:{},specificErrors:{}},h=0;h<e.length;h+=1){var c=e[h];if(!r||c===r){var g=r?N(c,s,a):N(c,s);g&&(u=!0,m=_(_(_({},m),i(g,["general","components"])),{},{general:_(_({},m.general),g.general),components:_(_({},m.components),g.components)})),"mwd"===c.family&&l.length>1&&(m.components[c.id].gamma_sensor_to_bit_distance="Only 1 gamma sensor allowed. Currently ".concat(l.length),u=!0)}}return o&&1===o.length?"bit"!==e[e.length-1].family&&"bit"!==e[0].family&&(m.general.bit_position='"BIT" category should be on the bottom of the list.',u=!0):(m.general.bit_count='Number of "BIT" components is invalid.',u=!0),u?m:null}function B(e){if(!e)return d;var t=e.data,r=t.id,n=t.start_timestamp_str,i=t.start_depth,o=t.components;if(!o)return d;var s=v({id:r,start_timestamp_str:n,start_depth:i}),a=P(o);return a&&(s=_(_({},s),a)),s}export{m as ctoi,h as ctop,f as isValidLinearWeight,g as isValidNumber,c as isValueEmpty,B as validate,p as validateCommon,N as validateComponent,D as validateComponentAgitator,j as validateComponentBit,T as validateComponentCt,w as validateComponentDc,b as validateComponentDefaullt,L as validateComponentDp,x as validateComponentHwdp,y as validateComponentJar,z as validateComponentLwd,q as validateComponentMwd,I as validateComponentPdm,E as validateComponentRss,O as validateComponentStabilizer,F as validateComponentSub,S as validateComponentUr,P as validateComponents,v as validateHeader};
